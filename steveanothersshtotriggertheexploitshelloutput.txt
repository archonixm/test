kali@kali:~/Downloads$ python 40920.py
Traceback (most recent call last):
  File "40920.py", line 45, in <module>
    import tornado.httpserver
ImportError: No module named tornado.httpserver
kali@kali:~/Downloads$ python3 40920.py
  File "40920.py", line 55
    global exploited
                   ^
TabError: inconsistent use of tabs and spaces in indentation
kali@kali:~/Downloads$ python2 40920.py
Traceback (most recent call last):
  File "40920.py", line 45, in <module>
    import tornado.httpserver
ImportError: No module named tornado.httpserver
kali@kali:~/Downloads$ pip2 install tornado
bash: pip2: command not found
kali@kali:~/Downloads$ pip3 install tornado
Requirement already satisfied: tornado in /usr/lib/python3/dist-packages (5.1.1)
kali@kali:~/Downloads$ python 40920.py
Traceback (most recent call last):
  File "40920.py", line 45, in <module>
    import tornado.httpserver
ImportError: No module named tornado.httpserver
kali@kali:~/Downloads$ ./nagios-root-privesc.sh
bash: ./nagios-root-privesc.sh: Permission denied
kali@kali:~/Downloads$ sudo ./nagios-root-privesc.sh
[sudo] password for kali: 
sudo: ./nagios-root-privesc.sh: command not found
kali@kali:~/Downloads$ sudo bash nagios-root-privesc.sh
 
Nagios Core - Root Privilege Escalation PoC Exploit (CVE-2016-9566) 
nagios-root-privesc.sh (ver. 1.0)

Discovered and coded by: 

Dawid Golunski 
https://legalhackers.com 

[+] Starting the exploit as: 
uid=0(root) gid=0(root) groups=0(root)

[!] You need to execute the exploit as 'nagios' user or 'nagios' group ! Exiting.

kali@kali:~/Downloads$ ssh -i id_rsa steve@192.168.40.81
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@         WARNING: UNPROTECTED PRIVATE KEY FILE!          @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Permissions 0644 for 'id_rsa' are too open.
It is required that your private key files are NOT accessible by others.
This private key will be ignored.
Load key "id_rsa": bad permissions
steve@192.168.40.81's password: 
Permission denied, please try again.
steve@192.168.40.81's password: 

kali@kali:~/Downloads$ ls
 10.10.10.176     40774.sh          auth.txt                      GetCLSID.ps1                      nagios-root-privesc.sh     slmailbadchar.py
 10.10.10.180     40871.c           AutoRecon                     id_rsa                            nc.exe                     smbmap
 10.10.10.181     40920.py          Azure-ADConnect.ps1           ImmunityDebugger_1_85_setup.exe   OS-53706-OSCP.ovpn         smbrute
 10.10.10.185     40921.sh          azuread_decrypt_msol_v2.ps1   JuicyPotato.exe                   pdfminer-20191125          SuperSecureServer.py
 17886.py         41457.c           azure.ps1                     LFISuite                          pdfminer-20191125.tar.gz   test_clsid.bat
 192.168.40.81    41458.c           connection.py                 LinEnum.sh                        pdfminer.six               test.txt
 23243.py         42966.py          download.txt                  linpeas.sh                        powershellcmd.txt.save     tomcat-cve-2017-12617.py
 34462-2.tar.gz   47169.c           evil-winrm                    linPEAS.sh                        pspy32s                    troubleshooting.sh
 398.pdf          48143.py          exam-connection.tar.bz2       logrotten.c                       pspy64s                    troubleshoot.log
 40674.py         71812.pdf         freefloat.py                  lshw                              rev.bat                    warftpd_65.exe
'40681(1).py'     archonixm.ovpn    fuzzdb                        mini-reverse.ps1                  rob.txt                    winPEAS.exe
 40681.py         authorized_keys   fuzzerslmail.py               nagios_cmd_injection.py           rob.txt.save
kali@kali:~/Downloads$ cd ..
kali@kali:~$ ls
authorized_keys  cherry.ctb~   cherry.ctb~~~     Desktop    Downloads       hash.txt  Music            Pictures  sparta.sprt         Templates
cherry.ctb       cherry.ctb~~  Confidential.txt  Documents  get-events.php  id_rsa    nagiosadmin.txt  Public    sparta-tool-output  Videos
kali@kali:~$ ssh -i id_rsa steve@192.168.40.81
Enter passphrase for key 'id_rsa': 
Welcome to Ubuntu 16.04.5 LTS (GNU/Linux 4.4.0-143-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

20 packages can be updated.
0 updates are security updates.


Last login: Mon Apr 27 13:36:40 2020 from 192.168.19.40
steve@harakiri:~$ sudo /usr/local/nagios/bin/bagios -d /usr/local/nagios/etc/nagios.cfg
[sudo] password for steve: 
steve@harakiri:~$ sudo /usr/local/nagios/bin/nagios -d /usr/local/nagios/etc/nagios.cfg
steve@harakiri:~$ 
